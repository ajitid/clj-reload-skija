{:paths ["src" "classes" "resources"]

 :deps
 {;; Flex - Vue 3-style reactive signals
  town.lilac/flex {:git/url "https://github.com/lilactown/flex"
                   :git/sha "f3d93a7c697dfc1c63c12e1f2a111fda8248d96a"}

  ;; Types - core classes shared by Skija
  io.github.humbleui/types {:mvn/version "0.2.0"}

  ;; Skija shared Java classes (local build)
  ;; Run: bb scripts/build-skija.clj
  io.github.humbleui/skija-shared {:local/root ".jars/skija-shared.jar"}

  ;; Color - color space conversions (OKLCH, etc.)
  clojure2d/clojure2d {:mvn/version "1.4.5"}

  ;; Math - noise, random, distributions, vectors, matrices
  generateme/fastmath {:mvn/version "2.4.0"}

  ;; LWJGL 3.4.0 with SDL3 and OpenGL
  org.lwjgl/lwjgl {:mvn/version "3.4.0"}
  org.lwjgl/lwjgl-sdl {:mvn/version "3.4.0"}
  org.lwjgl/lwjgl-opengl {:mvn/version "3.4.0"}

  ;; Java Sound SPIs for OGG + MP3 (Java 17+ modularized)
  dev.mccue/mp3spi {:mvn/version "2024.04.19"}
  dev.mccue/vorbisspi {:mvn/version "2024.04.19"}

  ;; JavaCV for video decoding (FFmpeg bindings)
  org.bytedeco/javacv {:mvn/version "1.5.10"}

  ;; JNA for platform-specific native API calls (IOSurface, VAAPI, etc.)
  net.java.dev.jna/jna {:mvn/version "5.14.0"}
  net.java.dev.jna/jna-platform {:mvn/version "5.14.0"}}

 :aliases
 {;; Platform-specific Skija + LWJGL natives
  ;; Run: bb scripts/build-skija.clj (to build Skija for your platform)
  :macos-arm64
  {:extra-deps
   {;; Local Skija build (run bb scripts/build-skija.clj first)
    io.github.humbleui/skija-macos-arm64 {:local/root ".jars/skija-macos-arm64.jar"}
    org.lwjgl/lwjgl$natives-macos-arm64 {:mvn/version "3.4.0"}
    org.lwjgl/lwjgl-sdl$natives-macos-arm64 {:mvn/version "3.4.0"}
    org.lwjgl/lwjgl-opengl$natives-macos-arm64 {:mvn/version "3.4.0"}
    ;; FFmpeg natives for video decoding
    org.bytedeco/ffmpeg$macosx-arm64 {:mvn/version "6.1.1-1.5.10"}}}

  :macos-x64
  {:extra-deps
   {;; Local Skija build (run bb scripts/build-skija.clj first)
    io.github.humbleui/skija-macos-x64 {:local/root ".jars/skija-macos-x64.jar"}
    org.lwjgl/lwjgl$natives-macos {:mvn/version "3.4.0"}
    org.lwjgl/lwjgl-sdl$natives-macos {:mvn/version "3.4.0"}
    org.lwjgl/lwjgl-opengl$natives-macos {:mvn/version "3.4.0"}
    ;; FFmpeg natives for video decoding
    org.bytedeco/ffmpeg$macosx-x86_64 {:mvn/version "6.1.1-1.5.10"}}}

  :windows
  {:extra-deps
   {;; Local Skija build (run bb scripts/build-skija.clj first)
    io.github.humbleui/skija-windows-x64 {:local/root ".jars/skija-windows-x64.jar"}
    org.lwjgl/lwjgl$natives-windows {:mvn/version "3.4.0"}
    org.lwjgl/lwjgl-sdl$natives-windows {:mvn/version "3.4.0"}
    org.lwjgl/lwjgl-opengl$natives-windows {:mvn/version "3.4.0"}
    ;; FFmpeg natives for video decoding
    org.bytedeco/ffmpeg$windows-x86_64 {:mvn/version "6.1.1-1.5.10"}}}

  :linux
  {:extra-deps
   {;; Local Skija build (run bb scripts/build-skija.clj first)
    io.github.humbleui/skija-linux-x64 {:local/root ".jars/skija-linux-x64.jar"}
    org.lwjgl/lwjgl$natives-linux {:mvn/version "3.4.0"}
    org.lwjgl/lwjgl-sdl$natives-linux {:mvn/version "3.4.0"}
    org.lwjgl/lwjgl-opengl$natives-linux {:mvn/version "3.4.0"}
    ;; FFmpeg natives for video decoding
    org.bytedeco/ffmpeg$linux-x86_64 {:mvn/version "6.1.1-1.5.10"}}}

  :dev
  {:extra-paths ["dev"]
   :extra-deps
   {io.github.tonsky/clj-reload {:mvn/version "1.0.0"}
    nrepl/nrepl {:mvn/version "1.5.1"}
    cider/cider-nrepl {:mvn/version "0.58.0"}
    com.nextjournal/beholder {:mvn/version "1.0.3"}}
   ;; Enable FFM native access for Metal async capture (JDK 22+)
   :jvm-opts ["--enable-native-access=ALL-UNNAMED"]}

  ;; Connect to running nREPL (doesn't load dev/ to avoid port conflict)
  :connect
  {:extra-deps {nrepl/nrepl {:mvn/version "1.5.1"}}
   :main-opts ["-m" "nrepl.cmdline" "--connect" "--port" "7888"]}

  :repl
  {:extra-deps {cider/cider-nrepl {:mvn/version "0.58.0"}}
   :main-opts ["-m" "nrepl.cmdline"
               "--middleware" "[cider.nrepl/cider-middleware]"]}}}
